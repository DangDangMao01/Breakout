# TRAE SOLO + Kiro 双工具协作策略

> 创建时间: 2026-01-14
> 适用场景: 同时拥有两个工具会员，需要优化成本和效率

## 一、智能体工作方式对比

### TRAE SOLO 智能体机制

```
用户输入: "创建一个待办事项应用"
    ↓
【SOLO Planner】分析需求
    ├─ 生成详细 PRD
    ├─ 分解任务列表
    └─ 制定执行计划
    ↓
【SOLO Coder】执行开发
    ├─ 创建项目结构
    ├─ 生成代码文件
    ├─ 实现功能模块
    └─ 写单元测试
    ↓
【SOLO Builder】构建部署
    ├─ 配置构建脚本
    ├─ 运行测试
    ├─ 打包应用
    └─ 部署到服务器
    ↓
【SOLO Reviewer】质量检查
    ├─ 代码审查
    ├─ 性能分析
    └─ 提出优化建议
```

**特点**:
- ✓ 多智能体自动协作
- ✓ 全流程自动化
- ✓ 可视化进度反馈
- ✗ 黑盒操作，难以精细控制
- ✗ 生成代码质量不稳定

### Kiro 智能体机制

```
用户输入: "修复登录模块的 bug"
    ↓
【context-gatherer】收集上下文
    ├─ 分析项目结构
    ├─ 识别相关文件
    ├─ 理解组件关系
    └─ 返回关键代码位置
    ↓
【Kiro 主智能体】执行任务
    ├─ 读取相关文件
    ├─ 分析问题原因
    ├─ 提出修复方案
    └─ 等待用户确认
    ↓
【用户确认】审查方案
    ├─ 检查修复逻辑
    ├─ 调整实现细节
    └─ 批准执行
    ↓
【Kiro】应用修改
    ├─ 修改代码
    ├─ 运行测试
    └─ 报告结果
```

**特点**:
- ✓ 透明可控，每步可审查
- ✓ 代码质量高
- ✓ 支持 Spec/Steering/Hooks 定制
- ✗ 需要更多人工参与
- ✗ Token 消耗较高

---

## 二、Kiro 多模型策略实现

### 当前 Kiro 的模型配置

Kiro 默认使用 **Claude Sonnet**，但可以通过以下方式扩展：

#### 方案 1: MCP 集成本地模型（推荐）

```json
// .kiro/settings/mcp.json
{
  "mcpServers": {
    "ollama-local": {
      "command": "node",
      "args": ["path/to/ollama-mcp-server.js"],
      "env": {
        "OLLAMA_HOST": "http://localhost:11434",
        "DEFAULT_MODEL": "qwen2.5:32b"
      },
      "disabled": false
    }
  }
}
```

**优势**:
- 本地运行，零成本
- 适合简单任务（代码补全、文档生成）
- 不消耗 Kiro 会员额度

#### 方案 2: Steering 规则优化 Token 消耗

```markdown
<!-- .kiro/steering/token-optimization.md -->
# Token 优化规则

## 原则
1. 优先使用简洁回复
2. 避免重复读取相同文件
3. 批量操作合并执行
4. 使用 strReplace 而非完整重写

## 场景策略
- 简单问答: 直接回答，不读文件
- 代码修改: 只读必要文件，使用 strReplace
- 新功能: 先 Spec 规划，再分批实现
```

#### 方案 3: Hooks 自动化减少交互

```json
// .kiro/hooks/auto-test.json
{
  "name": "自动测试",
  "trigger": "onFileSave",
  "filePattern": "**/*.ts",
  "action": "command",
  "command": "npm test -- --related ${file}"
}
```

**效果**: 减少手动触发测试的对话次数

---

## 三、成本效益分析

### Token 消耗对比（估算）

| 任务类型 | SOLO 消耗 | Kiro 消耗 | 差异 |
|---------|----------|----------|------|
| 创建新项目 | 免费（会员内） | ~50K tokens | SOLO 优 |
| 修复单个 Bug | 免费 | ~10K tokens | SOLO 优 |
| 代码重构 | 免费 | ~30K tokens | SOLO 优 |
| 精细调整 | 不适用 | ~5K tokens | Kiro 优 |
| 团队协作 | 不适用 | ~15K tokens | Kiro 优 |

### 会员成本对比

| 项目 | TRAE SOLO | Kiro |
|------|-----------|------|
| **月费** | ¥0-99（推广期） | $20-50（估算） |
| **使用限制** | 可能有请求次数限制 | Token 额度限制 |
| **超额费用** | 未知 | 按 Token 计费 |

---

## 四、双工具协作最佳实践

### 核心原则: **SOLO 打草稿，Kiro 做精品**

### 场景 1: 新项目开发

```
阶段 1: 快速原型（SOLO）
├─ 用 SOLO 生成项目骨架
├─ 实现核心功能原型
├─ 快速验证可行性
└─ 成本: 0 Token（SOLO 会员内）

阶段 2: 代码审查（Kiro）
├─ 用 Kiro 审查 SOLO 生成的代码
├─ 识别潜在问题
├─ 提出优化建议
└─ 成本: ~10K tokens

阶段 3: 精细重构（Kiro）
├─ 重构关键模块
├─ 优化性能
├─ 添加错误处理
└─ 成本: ~20K tokens

阶段 4: 功能迭代（SOLO + Kiro）
├─ 新功能用 SOLO 快速实现
├─ 核心逻辑用 Kiro 精细调整
└─ 成本: 混合，按需选择
```

**总成本**: ~30K tokens（相比纯 Kiro 节省 40%）

### 场景 2: Bug 修复

```
简单 Bug → SOLO
├─ 明确的错误信息
├─ 单文件修改
└─ 成本: 0 tokens

复杂 Bug → Kiro
├─ 需要跨文件分析
├─ 涉及架构问题
├─ 需要精确定位
└─ 成本: ~15K tokens
```

### 场景 3: 代码重构

```
大规模重构 → SOLO 初步 + Kiro 精修
├─ SOLO: 生成重构后的代码框架
├─ Kiro: 审查并优化细节
└─ 成本: ~25K tokens（纯 Kiro 需 50K）

局部重构 → Kiro
├─ 精确控制重构范围
├─ 保持代码风格一致
└─ 成本: ~10K tokens
```

### 场景 4: 文档生成

```
API 文档 → SOLO
├─ 自动生成基础文档
├─ 快速覆盖所有接口
└─ 成本: 0 tokens

技术设计文档 → Kiro
├─ 需要深度理解架构
├─ 需要专业术语
└─ 成本: ~8K tokens
```

---

## 五、实战工作流程

### 日常开发流程

```
早上（规划阶段）
├─ Kiro: 查看 Spec，规划今日任务
└─ 成本: ~2K tokens

上午（快速开发）
├─ SOLO: 实现新功能模块
├─ SOLO: 生成单元测试
└─ 成本: 0 tokens

中午（代码审查）
├─ Kiro: 审查 SOLO 生成的代码
├─ Kiro: 识别潜在问题
└─ 成本: ~5K tokens

下午（精细调整）
├─ Kiro: 重构关键逻辑
├─ Kiro: 优化性能
└─ 成本: ~10K tokens

晚上（文档整理）
├─ SOLO: 生成 API 文档
├─ Kiro: 更新技术文档
└─ 成本: ~3K tokens

每日总成本: ~20K tokens（纯 Kiro 需 40K+）
```

### 项目类型选择策略

| 项目类型 | 主力工具 | 辅助工具 | 原因 |
|---------|---------|---------|------|
| **个人项目** | SOLO | Kiro | 快速迭代，成本低 |
| **商业项目** | Kiro | SOLO | 代码质量优先 |
| **学习项目** | SOLO | - | 快速验证想法 |
| **开源项目** | Kiro | SOLO | 代码规范重要 |
| **原型验证** | SOLO | - | 速度第一 |
| **生产代码** | Kiro | SOLO | 质量第一 |

---

## 六、具体操作建议

### 1. 项目初始化（SOLO）

```bash
# 在 SOLO 中
"创建一个 React + TypeScript + Vite 项目，
包含路由、状态管理、API 封装"

# SOLO 自动完成:
# - 项目结构
# - 依赖安装
# - 基础配置
# - 示例代码
```

### 2. 代码审查（Kiro）

```bash
# 在 Kiro 中
"审查 SOLO 生成的代码，重点检查:
1. TypeScript 类型安全
2. 错误处理
3. 性能优化点
4. 安全隐患"

# Kiro 会:
# - 深度分析代码
# - 提供详细报告
# - 给出修改建议
```

### 3. 关键模块重构（Kiro）

```bash
# 在 Kiro 中
"重构 API 封装模块，要求:
1. 统一错误处理
2. 添加请求重试
3. 实现请求缓存
4. 类型安全"

# Kiro 会:
# - 精确修改
# - 保持代码风格
# - 添加注释
```

### 4. 新功能快速实现（SOLO）

```bash
# 在 SOLO 中
"添加用户认证功能:
- JWT token 管理
- 登录/注册页面
- 权限路由守卫"

# SOLO 快速生成
```

### 5. 功能优化（Kiro）

```bash
# 在 Kiro 中
"优化认证模块:
1. 添加 token 自动刷新
2. 实现记住登录状态
3. 优化错误提示"

# Kiro 精细调整
```

---

## 七、成本优化技巧

### Kiro 使用技巧

1. **批量操作**
   ```
   ❌ 不好: "修改 A 文件" → "修改 B 文件" → "修改 C 文件"
   ✓ 好: "同时修改 A、B、C 文件，实现 XX 功能"
   ```

2. **使用 Spec 规划**
   ```
   ❌ 不好: 边聊边改，反复调整
   ✓ 好: 先写 Spec，明确需求，一次性实现
   ```

3. **利用 Steering 规则**
   ```
   ❌ 不好: 每次都重复说明代码规范
   ✓ 好: 写入 Steering，自动遵守
   ```

4. **善用 Context-Gatherer**
   ```
   ❌ 不好: 手动指定所有相关文件
   ✓ 好: 让 context-gatherer 自动识别
   ```

### SOLO 使用技巧

1. **明确需求**
   ```
   ❌ 不好: "做个网站"
   ✓ 好: "创建电商网站，包含商品列表、购物车、订单管理"
   ```

2. **分阶段实现**
   ```
   ❌ 不好: 一次性要求所有功能
   ✓ 好: 先核心功能，再逐步扩展
   ```

3. **及时保存**
   ```
   ✓ SOLO 生成代码后立即 Git commit
   ✓ 方便后续用 Kiro 对比和优化
   ```

---

## 八、月度成本预估

### 纯 Kiro 方案

```
日常开发: 40K tokens/天 × 20 天 = 800K tokens/月
项目重构: 100K tokens/次 × 2 次 = 200K tokens/月
文档编写: 20K tokens/周 × 4 周 = 80K tokens/月
---
总计: ~1.1M tokens/月
成本: ~$50-80/月（超出会员额度部分）
```

### SOLO + Kiro 混合方案

```
SOLO 承担:
- 新功能开发: 0 tokens（会员内）
- 原型验证: 0 tokens
- 文档生成: 0 tokens

Kiro 承担:
- 代码审查: 10K tokens/天 × 20 天 = 200K tokens/月
- 精细重构: 50K tokens/次 × 2 次 = 100K tokens/月
- 技术文档: 10K tokens/周 × 4 周 = 40K tokens/月
---
总计: ~340K tokens/月
成本: ~$20-30/月（会员内）

节省: 70% 成本 + 50% 时间
```

---

## 九、推荐配置

### Git 工作流

```bash
# 分支策略
main          ← 生产代码（Kiro 维护）
  ├─ develop  ← 开发分支（Kiro 维护）
  │   ├─ feature/solo-xxx  ← SOLO 生成的功能
  │   └─ feature/kiro-xxx  ← Kiro 精细开发
  └─ hotfix   ← 紧急修复（Kiro 处理）
```

### 项目结构

```
project/
├─ .solo/          # SOLO 配置
├─ .kiro/          # Kiro 配置
│   ├─ steering/   # 代码规范
│   └─ specs/      # 功能规划
├─ docs/
│   ├─ solo-generated/  # SOLO 生成的文档
│   └─ kiro-refined/    # Kiro 精修的文档
└─ src/
```

---

## 十、总结

### 黄金法则

1. **SOLO 负责"从 0 到 1"** - 快速生成、验证想法
2. **Kiro 负责"从 1 到 100"** - 精细打磨、生产就绪
3. **成本优化 70%** - 合理分工，各取所长
4. **效率提升 50%** - 并行工作，减少等待

### 快速决策表

| 问题 | 选择 |
|------|------|
| 需要快速验证想法？ | SOLO |
| 需要生产级代码？ | Kiro |
| 不确定技术方案？ | SOLO 试错 |
| 需要团队协作？ | Kiro |
| 预算紧张？ | SOLO 为主 |
| 质量优先？ | Kiro 为主 |
| 学习新技术？ | SOLO |
| 重构遗留代码？ | Kiro |

---

**最后更新**: 2026-01-14
**适用版本**: TRAE SOLO 2025+ / Kiro 2026+
