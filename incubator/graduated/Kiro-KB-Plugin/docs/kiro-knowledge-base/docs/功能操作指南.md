# Kiro Knowledge Base 插件功能操作指南

> 版本: 2.30.0  
> 更新日期: 2025-12-30

---

## 一、需要用户操作的功能

### 1. 初始设置 (必须)

| 功能 | 命令 | 说明 |
|------|------|------|
| 设置知识库 | `Kiro KB: 设置知识库` | 首次使用必须执行，设置中央知识库路径 |

**操作步骤：**
1. `Ctrl+Shift+P` → 输入 `Kiro KB: 设置知识库`
2. 输入中央知识库路径（如 `D:\KiroKnowledgeBase`）
3. 插件自动创建目录结构和 Steering 规则
4. **v2.27.4 新增**：自动配置 MCP filesystem，将知识库路径添加到允许目录

> 💡 **MCP 自动配置**：设置知识库时，插件会自动将路径添加到 `~/.kiro/settings/mcp.json` 的 filesystem 允许目录中，解决跨设备使用时 Kiro Agent 无法访问中央知识库的问题。配置后需重启 Kiro 使配置生效。

---

### 2. 日常主动操作

| 功能 | 命令/快捷键 | 触发方式 | 说明 |
|------|-------------|----------|------|
| 暂存问题 | `Kiro KB: 暂存问题` / `Ctrl+Alt+Q` | 手动 | 记录想法或问题到待办队列 |
| 智能捕获 | `Kiro KB: 智能捕获` / `Ctrl+Alt+C` | 手动 | 一键捕获内容，自动分类（领域/类型/难度） |
| 查看待办 | 点击状态栏 `📋` 或命令 | 手动 | 查看和处理待办问题列表 |
| 同步到中央 | `Kiro KB: 同步到中央仓库` | 手动 | 将本地知识同步到中央知识库 |
| 生成索引 | `Kiro KB: 生成索引` | 手动 | 更新 INDEX.md 索引文件 |
| 智能分类 | `Kiro KB: 智能分类` | 手动 | 对当前文件进行智能分类 |
| 批量分类 | `Kiro KB: 批量分类` | 手动 | 批量分类未分类的知识文件 |
| 相似检测 | `Kiro KB: 检测相似内容` | 手动 | 检测当前文件与知识库中的相似内容 |
| 标签规范化 | `Kiro KB: 规范化标签` | 手动 | 分析并规范化知识库中的所有标签 |
| 质量评估 | `Kiro KB: 质量评估` | 手动 | 对当前文件进行质量评估（5维度10分制） |
| 批量质量评估 | `Kiro KB: 批量质量评估` | 手动 | 批量评估知识库文件质量 |
| 构建知识图谱 | `Kiro KB: 构建知识图谱` | 手动 | 构建知识节点关联图谱，分析知识关系 |
| 相关推荐 | `Kiro KB: 相关推荐` | 手动 | 基于当前文件获取相关知识推荐 |
| 清理分析 | `Kiro KB: 分析清理建议` | 手动 | 分析知识库，生成清理/归档建议 |
| 归档文件 | `Kiro KB: 归档文件` | 手动 | 手动选择文件进行归档 |
| 打开知识库 | `Kiro KB: 打开知识库` | 手动 | 打开中央知识库（多种方式） |
| 创建项目 | `Kiro KB: 创建项目` | 手动 | 在中央知识库创建新项目 |
| 打开项目 | `Kiro KB: 打开项目` | 手动 | 打开已有项目目录 |
| 迁移到项目 | `Kiro KB: 迁移到项目` | 手动 | 将 notes 下的 *-docs 文件夹迁移到 projects 目录 |
| 绑定项目 | `Kiro KB: 绑定项目` | 手动 | 手动绑定当前项目到中央知识库项目 |
| 同步到中央项目 | `Kiro KB: 同步到中央项目` | 手动 | 同步本地知识库到绑定的中央项目 |
| 提取代码注释 | `Kiro KB: 提取代码注释` | 手动 | 从代码中提取 TODO/FIXME/NOTE/BUG 注释 |
| 插入知识链接 | `Kiro KB: 插入知识链接` / `Ctrl+Alt+L` | 手动 | 快速插入知识库文件链接 |
| 显示相关知识 | `Kiro KB: 显示相关知识` / `Ctrl+Shift+Alt+R` | 手动 | 显示当前文件的相关知识推荐 |
| 修复编码 | `Kiro KB: 修复编码` | 手动 | 为 Markdown 文件添加 UTF-8 BOM，解决跨设备中文乱码 (v2.39.0) |
| 提交到中央 | `Kiro KB: 提交到中央` | 手动 | 将本地待办批量提交到中央 |
| 分析待办 | `Kiro KB: 分析待办问题` | 手动 | 生成批量分析任务文档 |
| 切换语言 | `Kiro KB: 切换语言` | 手动 | 切换中文/英文界面 |
| 切换错误报告 | `Kiro KB: 切换错误报告` | 手动 | 启用/禁用错误报告功能 |
| 显示日志 | `Kiro KB: 显示日志` | 手动 | 打开输出面板查看插件运行日志 |

---

### 2.1 智能捕获详解 (v2.22.0)

智能捕获功能现已集成分类引擎，使用流程：

1. 按 `Ctrl+Alt+C` 或执行 `Kiro KB: 智能捕获`
2. 输入标题
3. 系统自动分析内容，显示：
   - 智能检测的类型（置信度百分比）
   - 预填充的标签建议
4. 确认或修改分类
5. 文件自动保存，包含完整元数据

**自动检测内容：**
- 领域：Unity/Kiro/DevOps/Web/AI/Database + 20+ 子领域
- 类型：solution/tutorial/reference/architecture/note
- 难度：beginner/intermediate/advanced/expert
- 标签：自动提取技术关键词

---

### 2.2 智能分类命令 (v2.22.0)

| 命令 | 说明 |
|------|------|
| `Kiro KB: 智能分类` | 对当前打开的 Markdown 文件进行智能分类，显示结果并可应用 |
| `Kiro KB: 批量分类` | 批量分类知识库中未分类的文件（domain 为空或 "other"） |

**单文件分类流程：**
1. 打开一个知识库 Markdown 文件
2. 执行 `Kiro KB: 智能分类`
3. 查看分类结果（领域/类型/难度/置信度/建议标签）
4. 选择"应用分类"更新文件，或"仅查看"不修改

**批量分类流程：**
1. 执行 `Kiro KB: 批量分类`
2. 选择要分类的知识库（本地/中央）
3. 确认开始批量分类
4. 等待处理完成（支持取消）

---

### 2.3 相似检测与标签管理 (v2.23.0)

| 命令 | 说明 |
|------|------|
| `Kiro KB: 检测相似内容` | 检测当前文件与知识库中其他文件的相似度 |
| `Kiro KB: 规范化标签` | 分析知识库标签，生成报告并可执行规范化 |

**相似检测功能：**
1. 打开一个知识库 Markdown 文件
2. 执行 `Kiro KB: 检测相似内容`
3. 系统扫描本地和中央知识库
4. 生成相似度报告，包含：
   - 🔴 重复内容（相似度 ≥70%）- 建议合并或删除
   - 🟡 高度相似（50%-70%）- 建议添加交叉引用
   - 🟢 部分相似（25%-50%）- 仅供参考

**标签规范化功能：**
1. 执行 `Kiro KB: 规范化标签`
2. 选择要分析的知识库（本地/中央）
3. 生成标签分析报告，包含：
   - 标签统计（总数、分布）
   - 标签云（Top 20）
   - 需要规范化的标签（中英文统一、大小写统一）
   - 相似标签（可能需要合并）
   - 低频标签（使用<2次）
4. 可选择执行自动规范化

---

### 2.3 相似检测与标签管理 (v2.23.0)

| 命令 | 说明 |
|------|------|
| `Kiro KB: 检测相似内容` | 检测当前文件与知识库中其他文件的相似度 |
| `Kiro KB: 规范化标签` | 分析知识库标签，生成报告并可执行规范化 |

**相似检测功能：**
1. 打开一个知识库 Markdown 文件
2. 执行 `Kiro KB: 检测相似内容`
3. 系统扫描本地和中央知识库
4. 生成相似度报告，包含：
   - 🔴 重复内容（相似度 ≥70%）- 建议合并或删除
   - 🟡 高度相似（50%-70%）- 建议添加交叉引用
   - 🟢 部分相似（25%-50%）- 仅供参考

**标签规范化功能：**
1. 执行 `Kiro KB: 规范化标签`
2. 选择要分析的知识库（本地/中央）
3. 生成标签分析报告，包含：
   - 标签统计（总数、分布）
   - 标签云（Top 20）
   - 需要规范化的标签（中英文统一、大小写统一）
   - 相似标签（可能需要合并）
   - 低频标签（使用<2次）
4. 可选择执行自动规范化

---

### 2.4 质量评分系统 (v2.24.0)

质量评分系统对知识条目进行多维度评估，帮助维护高质量的知识库。

**评估维度（满分10分）：**

| 维度 | 权重 | 检查内容 |
|------|------|----------|
| 结构完整性 | 25% | YAML front-matter、标题、章节数量、关键章节（背景/方案/注意事项） |
| 内容深度 | 25% | 字数、代码块数量、列表项、链接/引用 |
| 元数据完整性 | 20% | domain、tags、date、source_project |
| 可读性 | 15% | 段落长度、格式化（加粗、行内代码、表格） |
| 时效性 | 15% | 基于 date 和 last_reviewed 计算新鲜度 |

**等级评定：**
- A (≥8.5分)：优秀
- B (≥7分)：良好
- C (≥5.5分)：合格
- D (≥4分)：需改进
- F (<4分)：不合格

**自动功能：**
- 生成改进建议：针对低分维度提供具体建议
- 复查检测：任何维度<4分或时效性<5分时标记需要复查
- 质量报告：生成详细的评估报告（支持中英文）

---

### 2.5 知识图谱构建器 (v2.24.0)

知识图谱构建器用于分析知识库中文件之间的关联关系。

**节点信息 (KnowledgeNode)：**
- 基础信息：id、filePath、title
- 分类信息：domain、subDomain、type
- 元数据：tags、date、quality（质量分数）

**边类型 (KnowledgeEdge)：**

| 类型 | 权重 | 说明 |
|------|------|------|
| domain | 0.3 | 同领域关联（子领域相同额外 +0.15） |
| tag | 0.2/标签 | 共享标签关联（最高 0.6） |
| similarity | 0.25+ | 标题相似度关联 |
| reference | - | 引用关联（预留） |

**主要功能：**
- `getRecommendations()` - 获取相关知识推荐
- `findIsolatedNodes()` - 查找孤立节点（无连接的知识）
- `findCoreNodes()` - 查找核心节点（高连接度的知识）
- `generateMermaidCode()` - 生成 Mermaid 可视化代码

---

### 2.6 生命周期管理 (v2.26.0)

生命周期管理功能帮助维护知识库健康，自动识别需要清理或归档的内容。

**清理分析功能：**
1. 执行 `Kiro KB: 分析清理建议`
2. 选择要分析的知识库（本地/中央）
3. 系统自动分析所有文件，生成清理报告
4. 报告包含：
   - 📉 低质量文件（质量分 < 4分）
   - ⏰ 过期文件（超过配置天数未更新）
   - 📋 重复内容（相似度 ≥ 70%）
5. 可选择执行自动归档

**手动归档功能：**
1. 执行 `Kiro KB: 归档文件`
2. 选择知识库
3. 多选要归档的文件
4. 选择归档原因：
   - 📉 低质量
   - ⏰ 已过期
   - 📋 重复内容
   - 🔄 已被替代
   - ✋ 手动归档
5. 确认后文件移动到 `archived/` 文件夹

**归档文件结构：**
归档的文件会添加元数据头部：
```html
<!-- ARCHIVED
original_path: 原始路径
archived_date: 归档日期
reason: 归档原因
reason_detail: 详细说明
quality_score: 质量分数
-->
```

**目录变更：**
归档后知识库新增 `archived/` 文件夹存放归档文件。

---

### 2.7 智能推荐系统 (v2.27.0)

智能推荐系统基于上下文分析和访问历史，自动推荐相关知识。

**上下文分析功能：**
- 自动检测当前编辑文件的类型（代码/Markdown/配置/文本）
- 识别文件中使用的技术栈（80+ 技术关键词）
- 推断可能的领域和子领域（如 `unity/shader`、`web/frontend`）
- 提取内容关键词用于匹配

**支持的文件类型：**
| 扩展名 | 类型 | 语言 | 默认领域 |
|--------|------|------|----------|
| .cs | 代码 | C# | Unity |
| .ts/.tsx | 代码 | TypeScript | Web |
| .py | 代码 | Python | - |
| .shader/.hlsl | 代码 | HLSL | Unity |
| .sql | 代码 | SQL | Database |
| .ps1 | 代码 | PowerShell | DevOps |
| .md | Markdown | - | - |
| .json/.yaml | 配置 | - | - |

**推荐算法维度：**
| 维度 | 权重 | 说明 |
|------|------|------|
| 领域匹配 | 3 × 置信度 | 同领域知识获得基础分 |
| 技术栈匹配 | 2/标签 | 共享技术标签加分 |
| 关键词匹配 | 1.5/词 | 标题/标签关键词匹配 |
| 访问历史 | 0.5-2 | 频率 + 时间衰减加权 |
| 质量分数 | 0.2 × 分 | 高质量知识额外加分 |

**时间衰减规则：**
- 1天内访问：+2分
- 7天内访问：+1.5分
- 30天内访问：+1分
- 90天内访问：+0.5分
- 超过90天：+0分

**推荐类型：**
- `context` - 基于当前上下文匹配
- `history` - 基于访问历史推荐
- `related` - 基于关联关系推荐
- `popular` - 基于热门程度推荐

---

### 2.8 项目分组管理 (v2.29.0)

项目分组功能允许按项目组织知识，便于管理大型知识库。

**侧边栏显示：**
- 📂 项目节点显示在侧边栏中（仅当 `projects/` 目录存在时）
- 每个项目显示状态图标和文件数量
- 支持展开查看项目内的子目录

**项目状态图标：**
| 状态 | 图标 | 说明 |
|------|------|------|
| active | 🟢 | 活跃项目 |
| paused | 🟡 | 暂停项目 |
| completed | ✅ | 已完成项目 |
| archived | 📦 | 已归档项目 |

**项目目录结构：**
```
projects/
└── my-project/
    ├── PROJECT.md      # 项目元数据（必需）
    ├── docs/           # 项目文档
    ├── solutions/      # 项目解决方案
    ├── notes/          # 项目笔记
    └── backlog/        # 项目待办
```

**PROJECT.md 格式：**
```yaml
---
status: active
description: "项目描述"
---

# 项目名称

项目详细说明...
```

**创建项目：**
1. 执行 `Kiro KB: 创建项目` 命令
2. 输入项目名称（将作为文件夹名）
3. 输入项目描述（可选）
4. 选择项目状态（active/paused/completed/archived）
5. 系统自动创建项目目录结构和 PROJECT.md

**打开项目：**
1. 执行 `Kiro KB: 打开项目` 命令
2. 从列表中选择要打开的项目
3. 项目目录将在新窗口中打开

**手动创建项目：**
1. 在中央知识库的 `projects/` 目录下创建项目文件夹
2. 创建 `PROJECT.md` 文件定义项目元数据
3. 根据需要创建 docs/solutions/notes/backlog 子目录
4. 刷新侧边栏即可看到新项目

---

### 2.9 项目迁移功能 (v2.29.1)

如果你之前在 `notes/` 目录下创建了以 `-docs` 结尾的项目文档文件夹（如 `my-project-docs/`），可以使用迁移功能将其转换为标准项目结构。

**迁移流程：**
1. 执行 `Kiro KB: 迁移到项目` 命令
2. 系统自动扫描 `notes/` 目录下以 `-docs` 结尾的文件夹
3. 选择要迁移的项目（支持多选）
4. 确认迁移
5. 系统自动：
   - 在 `projects/` 下创建项目目录（去掉 `-docs` 后缀）
   - 创建标准子目录结构（docs/solutions/notes/backlog）
   - 将原文件移动到 `docs/` 子目录
   - 生成 `PROJECT.md` 元数据文件
   - 删除原 `-docs` 文件夹

**迁移示例：**
```
迁移前:
notes/
└── my-project-docs/
    ├── design.md
    └── api-spec.md

迁移后:
projects/
└── my-project/
    ├── PROJECT.md          # 自动生成
    ├── docs/
    │   ├── design.md       # 从原目录移动
    │   └── api-spec.md
    ├── solutions/          # 空目录
    ├── notes/              # 空目录
    └── backlog/            # 空目录
```

**注意事项：**
- 如果目标项目目录已存在，该项目会被跳过
- 迁移会保留原始路径信息在 PROJECT.md 的 `migrated_from` 字段中
- 迁移后刷新侧边栏即可看到新项目

---

### 2.10 项目绑定功能 (v2.30.0)

项目绑定功能将本地项目与中央知识库项目关联，实现双向同步。

**自动绑定检测：**
打开项目时，插件会自动检测：
1. 如果中央知识库有同名项目 → 提示绑定
2. 如果本地有 `knowledge-base/` 但中央无同名项目 → 提示创建并绑定

**手动绑定：**
1. 执行 `Kiro KB: 绑定项目` 命令
2. 选择要绑定的中央项目，或创建新项目
3. 系统自动创建绑定配置文件

**绑定配置文件 (`.kiro-kb-binding.json`)：**
```json
{
  "centralProjectId": "my-project",
  "centralProjectPath": "D:/G_GitHub/Kiro-Central-KB/projects/my-project",
  "autoSync": true,
  "extractComments": true,
  "lastSync": "2025-12-30T10:00:00.000Z"
}
```

**绑定后的功能：**
- 实时同步：本地知识库文件保存时自动同步到中央
- 项目待办关联：中央项目的待办会在打开本地项目时提示
- 双向路径记录：中央 PROJECT.md 记录 `local_path`

---

### 2.11 实时同步功能 (v2.30.0)

绑定项目后，本地知识库文件保存时会自动同步到中央项目。

**触发条件：**
- 项目已绑定（存在 `.kiro-kb-binding.json`）
- 绑定配置中 `autoSync: true`
- 保存的文件在 `knowledge-base/` 目录下
- 文件扩展名为 `.md`

**同步规则：**
- 本地 `knowledge-base/solutions/` → 中央 `projects/<name>/solutions/`
- 本地 `knowledge-base/notes/` → 中央 `projects/<name>/notes/`
- 本地 `knowledge-base/discussions/` → 中央 `projects/<name>/discussions/`
- 本地 `knowledge-base/backlog/` → 中央 `projects/<name>/backlog/`

**手动同步：**
执行 `Kiro KB: 同步到中央项目` 可手动触发完整同步。

---

### 2.12 代码注释提取 (v2.30.0)

从代码中提取 TODO/FIXME/NOTE/BUG 等注释，生成知识库报告。

**支持的注释类型：**
| 类型 | 图标 | 匹配模式 |
|------|------|----------|
| TODO | 📋 | `// TODO:` 或 `# TODO:` |
| FIXME | 🔧 | `// FIXME:` 或 `# FIXME:` |
| NOTE | 📝 | `// NOTE:` 或 `# NOTE:` |
| HACK | ⚠️ | `// HACK:` |
| BUG | 🐛 | `// BUG:` |

**支持的文件类型：**
`.ts`, `.js`, `.tsx`, `.jsx`, `.py`, `.cs`, `.java`, `.cpp`, `.c`, `.go`, `.rs`, `.swift`

**使用流程：**
1. 执行 `Kiro KB: 提取代码注释` 命令
2. 选择扫描范围：当前文件 / 整个项目
3. 等待扫描完成
4. 查看生成的报告（自动保存到 `knowledge-base/notes/`）

**生成的报告格式：**
```markdown
# 代码注释提取报告

提取时间: 2025-12-30 10:00:00
项目: my-project
总计: 15 条注释

## 📋 TODO (8)

- [ ] **实现用户认证功能**
  - 📁 `src/auth.ts:42`

## 🔧 FIXME (5)

- [ ] **修复内存泄漏问题**
  - 📁 `src/utils.ts:128`
```

**应用场景：**
- 代码审查前生成待办清单
- 技术债务追踪
- 项目交接文档

---

### 3. 待办问题处理 (手动选择)

在查看待办时，用户需要选择操作：

| 操作 | 说明 |
|------|------|
| 📂 打开来源项目 | **v2.28.0 新增** 打开问题产生的项目（仅当项目路径存在时显示） |
| ✅ 解决 | 标记问题已解决，自动归档到 solutions/ |
| 🤖 让 Kiro 分析 | 提示用户告诉 Kiro 分析问题 |
| ☁️ 提交到中央 | 将本地问题提交到中央知识库 |
| 🗑️ 删除 | 软删除，保留 60 天后自动清理 |

---

### 4. 可选配置 (推荐)

| 配置项 | 位置 | 说明 |
|--------|------|------|
| Agent Hooks | `.kiro/hooks/` | 配置自动化 Hook（见下方详细说明） |
| 配置项调整 | VS Code 设置 | 调整空闲提醒、自动同步等参数 |

---

## 二、自动执行的功能 (无需操作)

### 1. 启动时自动检测

| 功能 | 触发条件 | 行为 |
|------|----------|------|
| 知识库结构检测 | 打开项目时 | 检测当前项目是否是知识库结构，提示设为中央 |
| 中央路径验证 | 打开项目时 | 验证配置的中央路径是否有效 |
| 本地待办检测 | 打开普通项目时 | 检测本地待办数量，提示处理 |
| 新文件同步检测 | 打开普通项目时 | 检测本地知识库新文件，提示同步 |
| 每日提醒检测 | 打开项目时 | 检测标记为每日提醒的待办项 |
| **项目待办检测** (v2.28.0) | 打开项目时 | 检测中央知识库中与当前项目相关的未处理问题，按优先级排序提示处理 |
| **项目绑定检测** (v2.30.0) | 打开项目时 | 检测是否有同名中央项目，提示绑定 |
| **实时同步** (v2.30.0) | 保存本地知识库文件时 | 自动同步到绑定的中央项目 |

### 2. 打开中央知识库时自动执行

| 功能 | 说明 |
|------|------|
| 新接收内容统计 | 显示自上次打开以来收到的新内容 |
| 中央待办检测 | 显示待处理和草稿数量，提示超期问题 |
| 过期删除清理 | 自动清理超过 60 天的已删除问题 |
| 知识库健康检查 | 检测缺少 YAML、未分类、相关文件等 |

### 3. 编辑时自动执行

| 功能 | 触发条件 | 说明 |
|------|----------|------|
| 空闲提醒 | 编辑 ≥20 次 + 工作 ≥5 分钟 + 空闲 10 分钟 | 提醒保存有价值内容 |
| 状态栏更新 | 待办数量变化时 | 自动更新状态栏显示 |
| 配置自动重载 | 修改 kiro-kb 配置时 | 无需重启，配置立即生效 |

### 4. 智能检测 (暂存问题时)

| 功能 | 说明 |
|------|------|
| 智能分类 | 根据关键词自动识别问题类型（Bug/功能/灵感/疑问） |
| 智能优先级 | 根据关键词自动识别优先级（高/普通/低） |
| 知识库关联 | 自动搜索知识库中的相关内容，避免重复提问 |

---

## 三、状态栏显示

| 图标 | 位置 | 功能 |
|------|------|------|
| 📋 待办: X (本地) \| Y (中央) | 左侧状态栏 | 显示待办数量，点击查看列表 |
| 💡 | 左侧状态栏 | 快速暂存问题按钮 |

---

## 四、配置项说明

| 配置项 | 默认值 | 说明 | 需要操作 |
|--------|--------|------|----------|
| `kiro-kb.centralPath` | "" | 中央知识库路径 | ✅ 首次设置 |
| `kiro-kb.autoSync` | false | 自动同步模式 | 可选 |
| `kiro-kb.idleReminderMinutes` | 10 | 空闲提醒间隔(分钟)，0=禁用 | 可选 |
| `kiro-kb.reminder.enabled` | true | 启用空闲提醒 | 可选 |
| `kiro-kb.reminder.minEdits` | 20 | 触发提醒的最小编辑次数 | 可选 |
| `kiro-kb.reminder.minMinutes` | 5 | 触发提醒的最小工作时长(分钟) | 可选 |
| `kiro-kb.errorReportEnabled` | true | 错误报告功能 | 可选 |
| `kiro-kb.backlogMode` | "auto" | 暂存模式：local/central/auto | 可选 |
| `kiro-kb.autoAnalyze` | "manual" | Kiro分析时机 | 可选 |
| `kiro-kb.language` | "zh" | 界面语言：zh/en | 可选 |
| `kiro-kb.reminderDays` | [7, 30] | 待办提醒天数 | 可选 |

---

## 五、Agent Hooks 配置 (推荐)

Agent Hooks 可以让 Kiro 自动执行知识库操作，**强烈推荐配置**！

### 推荐的 Hooks

| Hook | 触发时机 | 功能 | 需要操作 |
|------|----------|------|----------|
| 自动保存知识 | 手动触发 | 智能评估（10分制）并保存有价值内容，自动反馈保存结果 | ✅ 需配置 |
| 自动检索知识库 | 已禁用 | 通过 Steering 规则实现，无需 Hook | 无需配置 |
| 自动更新索引 | 知识库文件变更 | 自动更新 INDEX.md | 可选 |
| 每日回顾提醒 | 手动触发 | 提醒处理待办问题 | 可选 |

> ⚠️ **注意**: `onAgentComplete` 和 `onSessionCreate` 触发器会频繁弹窗干扰开发，建议改为手动触发或通过 Steering 规则实现。

### 配置方法

**方法一：使用模板文件**
1. 从 `hooks-templates/` 复制 `.json` 文件到 `.kiro/hooks/`
2. 修改 `{{CENTRAL_KB_PATH}}` 为实际路径
3. 重启 Kiro

**方法二：通过 Kiro UI**
1. 在 Agent Hooks 面板点击 `+`
2. 输入描述：`auto save kb` 或 `auto search kb`

---

## 六、目录结构

```
中央知识库/
├── INDEX.md              # 自动生成的索引
├── PROGRESS.md           # 进度追踪
├── README.md             # 说明文档
├── discussions/          # 问题探讨
├── solutions/            # 解决方案
├── notes/                # 学习笔记
├── archived/             # 归档文件 (v2.26.0)
├── projects/             # 项目分组 (v2.29.0)
│   └── <project-name>/   # 项目目录
│       ├── PROJECT.md    # 项目元数据
│       ├── docs/         # 项目文档
│       ├── solutions/    # 项目解决方案
│       ├── notes/        # 项目笔记
│       └── backlog/      # 项目待办
└── backlog/              # 待办问题
    ├── pending/          # 待处理
    ├── draft/            # 已分析草稿
    ├── deleted/          # 已删除（保留60天）
    └── BACKLOG-INDEX.md  # 待办索引
```

---

## 七、MCP Filesystem 配置

如果使用 MCP filesystem 服务器访问中央知识库，需要将知识库路径添加到允许目录。

### 自动配置（v2.27.4 默认行为）

**从 v2.27.4 开始，设置知识库时会自动配置 MCP filesystem**，无需手动操作。

插件会自动：
1. 检测 `~/.kiro/settings/mcp.json` 是否存在
2. 检查 filesystem 服务器是否已配置
3. 将知识库路径添加到允许目录（如果尚未添加）
4. 提示用户重启 Kiro 使配置生效

### 脚本配置（备选）

如果自动配置未生效，可运行脚本手动添加路径：

```powershell
powershell -File ".\scripts\setup-mcp-filesystem.ps1" -KBPath "D:\G_GitHub\Kiro-Central-KB"
```

### 手动配置（备选）

编辑 `~/.kiro/settings/mcp.json`，在 `filesystem.args` 中添加知识库路径：

```json
{
  "mcpServers": {
    "filesystem": {
      "args": [
        "existing-path",
        "D:\\G_GitHub\\Kiro-Central-KB"
      ]
    }
  }
}
```

> ⚠️ 配置后需重启 Kiro 或重连 MCP 服务器

---

## 八、快速参考

### 必须操作 (1次)
- ✅ 设置中央知识库路径

### 推荐操作 (1次)
- ✅ 配置 Agent Hooks

### 日常操作
- 💡 暂存问题 (`Ctrl+Alt+Q`)
- 📋 查看/处理待办
- 🔄 同步到中央（有新内容时）
- 📊 生成索引（定期）
- 🔍 检测相似内容（保存前检查重复）
- 🏷️ 规范化标签（定期维护）
- 🗃️ 清理分析（定期维护知识库健康）

### 无需操作
- 🤖 智能分类/优先级检测
- 🔍 知识库关联搜索
- ⏰ 空闲提醒
- 📥 新接收内容统计
- 🧹 过期删除清理
- ✅ 知识库健康检查
