# Kiro KB v2.47.0 开发计划

**版本**: v2.47.0  
**计划日期**: 2026-01-05  
**预计完成**: 2026-01-12  
**开发策略**: 快速增强用户体验

---

## 🎯 版本目标

在 v2.46.0 的 TF-IDF 语义搜索基础上，进一步提升用户体验和知识管理效率。

**核心理念**: 小步快跑，快速迭代，每个功能都要实用且易用。

---

## ✨ 计划功能（3个）

### 1. 智能链接建议 🔗

**优先级**: 🔥 高  
**预计工时**: 2-3 小时  
**价值**: ⭐⭐⭐⭐⭐

#### 功能描述
在编辑 Markdown 文件时，输入 `[[` 自动触发知识库文件补全，支持模糊搜索。

#### 技术实现
- 使用 VSCode `CompletionItemProvider` API
- 触发字符: `[[`
- 扫描知识库所有 `.md` 文件
- 提供文件名、标题、标签的模糊匹配
- 补全格式: `[[文件名|显示文本]]`

#### 实现步骤
1. ✅ 已有 `backlinks.ts` 基础代码
2. 创建 `WikiLinkCompletionProvider` 类（已存在）
3. 注册 CompletionProvider
4. 实现模糊搜索算法
5. 添加预览功能（悬停显示）

#### 测试用例
- 输入 `[[` 触发补全
- 输入 `[[vsc` 匹配 "vscode-extension-..."
- 输入 `[[优化` 匹配包含"优化"的文件
- 悬停链接显示预览

---

### 2. 知识缺口分析集成 📊

**优先级**: 🔥 高  
**预计工时**: 1-2 小时  
**价值**: ⭐⭐⭐⭐

#### 功能描述
分析知识库，识别缺失的知识领域，提供学习建议。

#### 技术实现
- ✅ 代码已在 `classifier.ts` 中实现（`KnowledgeGapAnalyzer`）
- 只需创建命令函数并集成到 UI

#### 实现步骤
1. 在 `extension.ts` 中创建 `analyzeKnowledgeGaps()` 函数
2. 调用 `gapAnalyzer.analyzeGaps()`
3. 生成缺口报告
4. 集成到健康度仪表盘
5. 添加快捷键 `Ctrl+Alt+G`

#### 输出格式
```markdown
# 知识缺口分析报告

## 📊 覆盖度统计
- 前端开发: 15 篇 ✅
- 后端开发: 3 篇 ⚠️
- 数据库: 1 篇 ❌

## 🎯 建议补充
1. 数据库设计与优化
2. 后端 API 开发
3. 性能监控与调优

## 📚 推荐学习路径
...
```

---

### 3. 搜索历史记录 🕐

**优先级**: 🟡 中  
**预计工时**: 1 小时  
**价值**: ⭐⭐⭐

#### 功能描述
记录用户的搜索历史，支持快速重复搜索和搜索建议。

#### 技术实现
- 使用 VSCode `globalState` 存储搜索历史
- 最多保存 50 条
- 在搜索框中显示历史记录
- 支持删除和清空

#### 实现步骤
1. 创建 `SearchHistory` 类
2. 在 `quickSearchKB()` 中记录搜索
3. 在搜索框中显示历史
4. 添加"清空历史"命令

#### UI 设计
```
🔍 快速搜索
━━━━━━━━━━━━━━━━━━━━
📜 搜索历史:
  🕐 Unity Shader 优化
  🕐 VSCode 插件开发
  🕐 React Hooks 最佳实践
━━━━━━━━━━━━━━━━━━━━
🔍 输入新查询...
```

---

## 🚀 开发流程

### Day 1-2: 智能链接建议
- [ ] 完善 `WikiLinkCompletionProvider`
- [ ] 实现模糊搜索
- [ ] 添加悬停预览
- [ ] 测试和调试

### Day 3: 知识缺口分析
- [ ] 创建命令函数
- [ ] 生成报告格式
- [ ] 集成到仪表盘
- [ ] 测试

### Day 4: 搜索历史
- [x] 实现 SearchHistory 类
- [x] 集成到搜索命令（关键词搜索）
- [ ] 集成到语义搜索
- [ ] UI 优化（显示历史记录）
- [ ] 测试

### Day 5: 测试和优化
- [ ] 完整功能测试
- [ ] 性能优化
- [ ] Bug 修复
- [ ] 文档更新

### Day 6-7: 发布准备
- [ ] 更新 CHANGELOG
- [ ] 编写发布说明
- [ ] 打包 VSIX
- [ ] 准备发布

---

## 📊 成功指标

### 功能指标
- ✅ 3 个新功能全部实现
- ✅ 所有测试用例通过
- ✅ 无严重 Bug

### 性能指标
- 链接补全响应 < 100ms
- 缺口分析 < 2s
- 搜索历史加载 < 50ms

### 用户体验指标
- 链接补全准确率 > 90%
- 缺口分析有用性 > 80%
- 搜索历史使用率 > 50%

---

## 🎨 UI/UX 改进

### 1. 统一图标风格
- 🔗 链接建议
- 📊 缺口分析
- 🕐 搜索历史

### 2. 快捷键优化
- `Ctrl+Alt+K`: 快速搜索
- `Ctrl+Alt+G`: 缺口分析
- `Ctrl+Alt+H`: 搜索历史

### 3. 通知优化
- 减少干扰性通知
- 重要信息使用 Toast
- 进度使用 Progress Bar

---

## 🐛 已知问题修复

### v2.46.0 反馈问题
1. [ ] TF-IDF 搜索中文分词精度
2. [ ] 大型知识库首次索引慢
3. [ ] 搜索结果预览截断

### 技术债务
1. [ ] 代码重构：提取公共函数
2. [ ] 类型定义：完善 TypeScript 类型
3. [ ] 测试覆盖：添加单元测试

---

## 📦 发布计划

### v2.47.0-beta (Day 5)
- 内部测试版本
- 收集反馈

### v2.47.0 (Day 7)
- 正式发布
- 更新文档
- 发布公告

---

## 🔮 v2.48.0 展望

### 计划功能
1. 持久化索引（提升性能）
2. 中文分词优化（jieba）
3. 批量重复检测
4. 相似度详情显示

### 长期规划
1. 向量搜索（Embedding）
2. AI 辅助查询优化
3. 多模态搜索
4. 知识社区集成

---

## 📝 开发笔记

### 技术选型
- **链接补全**: VSCode CompletionProvider API
- **模糊搜索**: Levenshtein Distance 或 Fuse.js
- **状态管理**: VSCode globalState/workspaceState

### 参考资料
- [VSCode Extension API](https://code.visualstudio.com/api)
- [CompletionProvider](https://code.visualstudio.com/api/references/vscode-api#CompletionItemProvider)
- [Markdown Link Syntax](https://www.markdownguide.org/basic-syntax/#links)

---

**维护者**: DangDangMao  
**创建日期**: 2026-01-05  
**最后更新**: 2026-01-05

