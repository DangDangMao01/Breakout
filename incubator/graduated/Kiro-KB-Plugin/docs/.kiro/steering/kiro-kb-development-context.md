---
inclusion: always
---

# Kiro KB 插件开发上下文

> 这个文件让 AI 快速了解项目的开发背景、已做的决策、规划思路

## 🎯 项目是什么

**Kiro KB** 是一个 VSCode/Kiro 插件，用于管理个人技术知识。

**核心功能**：
- 保存和整理 AI 对话
- 知识分类和搜索
- 跨设备同步（通过 Git）
- 本地 AI 辅助（Ollama，规划中）

**代码位置**：`kiro-knowledge-base/extension/`

## 📍 当前版本状态

**最新稳定版**：v2.52.0
- 首次使用引导系统（setupWizard.ts）
- 简化版侧边栏（simplifiedPanel.ts）
- 帮助系统（helpSystem.ts）
- 已打包：`kiro-knowledge-base-2.52.0.vsix`

**版本号位置**（打包前必须同步更新）：
1. `package.json` 的 `version` 字段
2. `extension.ts` 第 47 行的 `PLUGIN_VERSION` 常量

## 🧭 开发规划思路

### 为什么分三个 Phase？

**Phase 1: 工作知识管理**（当前）
- 先解决最痛的问题：AI 对话丢失、知识碎片化
- 技术上最简单，能快速验证价值

**Phase 2: 知识消耗**（下一步）
- 手机上看到好内容，想保存到知识库
- Telegram Bot 是最轻量的方案（不需要开发 App）
- 优先级提升原因：知识付费墙越来越多，需要快速内化

**Phase 3: 本地 AI 记忆**（未来）
- Ollama 集成，实现真正的本地 AI
- 依赖 Phase 1/2 积累的知识数据
- 技术复杂度高，放最后

### 为什么选择这些技术？

| 选择 | 原因 | 放弃的方案 |
|------|------|-----------|
| Markdown + Git | 可迁移、版本控制、隐私 | 数据库（锁定）、云存储（隐私） |
| VSCode 插件 | 开发者日常工具、生态成熟 | 独立 App（开发成本高） |
| Ollama | 本地运行、隐私、免费 | OpenAI API（付费、隐私） |
| Telegram Bot | 轻量、跨平台、免费 | 自建 App（开发成本高） |

## ⚠️ 已踩过的坑

### 1. v2.52.0 侧边栏 Bug（2026-01-12 修复）

**问题**：跨设备开发后，打包的版本侧边栏空白
**原因**：`extension.ts` 的 `PLUGIN_VERSION` 常量没更新（还是 2.49.0）
**教训**：版本号有两个地方要同步更新

### 2. Ollama 集成导致插件崩溃（v2.49.0）

**问题**：Ollama 初始化失败会阻塞整个插件
**原因**：异步初始化没有错误隔离
**解决**：v2.50.0 添加了超时保护和错误隔离
**教训**：可选功能不能影响核心功能

### 3. 跨设备开发思路不一致

**问题**：换设备后 AI 读了上下文，但给出不同的建议
**原因**：AI 读的是"状态快照"，不是"决策过程"
**解决**：创建 Steering 文件记录"为什么这样做"
**教训**：记录决策过程，不只是结果

## 🔮 未来考虑的功能

### 已确定要做

- [ ] Telegram Bot（Phase 2）
- [ ] Ollama 智能问答（Phase 3）
- [ ] 工作日报/周报生成（Phase 3）

### 考虑中

- [ ] Trae IDE 支持（用户请求，见 `docs/feature-request-trae-support.md`）
- [ ] 知识缺口分析
- [ ] 付费内容 ROI 评估

### 明确不做

- ❌ 云端存储（隐私风险）
- ❌ 社交分享（专注个人）
- ❌ 复杂知识图谱可视化（保持简单）
- ❌ 市场/投资预测（AI 能力边界）

## 📚 关键文档索引

| 文档 | 内容 | 什么时候读 |
|------|------|-----------|
| `SESSION-STATE.md` | 当前开发状态 | 每次开始开发 |
| `DEVELOPMENT-ROADMAP.md` | 任务列表和时间线 | 规划工作时 |
| `PRE-PACKAGE-CHECKLIST.md` | 打包前检查清单 | 每次打包前 |
| `kiro-knowledge-base/CHANGELOG.md` | 版本变更历史 | 了解历史变更 |

## 💡 开发原则

1. **先读后写** - 新设备先读上下文，确认理解正确
2. **小步提交** - 每完成一个小功能就更新文档
3. **版本号同步** - package.json 和 extension.ts 必须一致
4. **功能隔离** - 可选功能（如 Ollama）不能影响核心功能
