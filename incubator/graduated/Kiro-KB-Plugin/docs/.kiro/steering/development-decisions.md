---
inclusion: always
---

# 开发决策记录规范

## 核心原则

跨设备开发的问题不是"读不到上下文"，而是"读到了但不理解决策过程"。

**必须记录的内容**：
1. **为什么**这样做（不只是做了什么）
2. **考虑过**哪些方案（为什么选择当前方案）
3. **放弃了**什么（避免重复踩坑）
4. **下一步**具体怎么做（不是模糊的"继续开发"）

## 开发日志格式

每次重要开发后，在 `SESSION-STATE.md` 或专门的日志文件中记录：

```markdown
## [日期] 开发决策

### 做了什么
- 具体完成的功能/修复

### 为什么这样做
- 选择这个方案的原因
- 考虑过的其他方案及放弃原因

### 关键代码位置
- 文件路径 + 行号
- 需要注意的实现细节

### 下一步（具体）
- 不要写"继续开发"
- 要写"在 extension.ts 第 X 行添加 Y 函数的调用"
```

## 版本开发检查点

每个版本开发时，必须明确：

1. **代码状态**
   - 新模块是否已创建？（文件名）
   - 是否已导入到 extension.ts？
   - 是否已注册命令？

2. **集成状态**
   - 哪些代码是"示例/参考"？
   - 哪些代码需要"复制到 extension.ts"？
   - 哪些代码"已经集成完成"？

3. **测试状态**
   - 编译是否通过？
   - 功能是否测试过？
   - 有哪些已知问题？

## 跨设备交接清单

切换设备前，必须更新 SESSION-STATE.md 包含：

```markdown
## 🔄 跨设备交接

### 当前代码状态
- 版本: v2.52.0
- 编译: ✅ 通过
- 打包: ✅ 完成

### 未完成的工作
- [ ] 具体任务1（文件: xxx.ts, 需要: 添加 Y 函数）
- [ ] 具体任务2（文件: xxx.ts, 需要: 修改 Z 逻辑）

### 关键决策
- 选择方案 A 而不是 B，因为...
- 放弃了 X 功能，因为...

### 下一步操作（具体步骤）
1. 打开 xxx.ts
2. 在第 Y 行添加...
3. 运行 npm run compile 验证
```

## AI 必须遵守

1. **不要假设** - 如果文档没写，就问用户
2. **不要重复造轮子** - 先检查是否已有实现
3. **不要跳过步骤** - 按文档记录的步骤执行
4. **记录你的决策** - 方便下一个 AI 实例理解
