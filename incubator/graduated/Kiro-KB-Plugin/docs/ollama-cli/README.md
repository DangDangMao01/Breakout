# Kiro KB Ollama CLI

ç‹¬ç«‹çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºæµ‹è¯• Kiro Knowledge Base çš„ Ollama æœ¬åœ° AI é›†æˆåŠŸèƒ½ã€‚

## åŠŸèƒ½

- âœ… æµ‹è¯• Ollama è¿æ¥
- âœ… ç”Ÿæˆæ¯æ—¥å·¥ä½œæ—¥æŠ¥
- âœ… ç”Ÿæˆæ¯å‘¨å·¥ä½œå‘¨æŠ¥
- âœ… **æ™ºèƒ½é—®ç­”** - è®©æœ¬åœ° AI è¯»å–çŸ¥è¯†åº“å›ç­”é—®é¢˜
- âœ… **å¤šè½®å¯¹è¯** - äº¤äº’å¼å¯¹è¯ï¼Œè®°ä½ä¸Šä¸‹æ–‡
- âœ… **ç½‘ç»œæœç´¢** - è®©æœ¬åœ° AI è·å–æœ€æ–°ä¿¡æ¯ï¼ˆDuckDuckGoï¼‰
- âœ… ç‹¬ç«‹è¿è¡Œï¼Œä¸ä¾èµ– Kiro IDE

## å‰ç½®æ¡ä»¶

1. **å®‰è£… Ollama**
   - ä¸‹è½½ï¼šhttps://ollama.com/download
   - å®‰è£…åè¿è¡Œï¼š`ollama serve`

2. **ä¸‹è½½ AI æ¨¡å‹**
   ```bash
   ollama pull qwen2.5:3b
   ```

3. **å®‰è£… Node.js**
   - ç‰ˆæœ¬ï¼š>= 18.0.0

## å®‰è£…

```bash
cd ollama-cli
npm install
npm run build
```

## å¿«é€Ÿå¯åŠ¨ï¼ˆWindowsï¼‰

æä¾›ä¸¤ä¸ªä¾¿æ·çš„æ‰¹å¤„ç†æ–‡ä»¶ï¼ŒåŒå‡»å³å¯ä½¿ç”¨ï¼š

| æ–‡ä»¶ | åŠŸèƒ½ | è¯´æ˜ |
|------|------|------|
| `å¯åŠ¨å¯¹è¯.bat` | å¤šè½®å¯¹è¯ | äº¤äº’å¼å¯¹è¯ï¼ŒAI è®°ä½ä¸Šä¸‹æ–‡ |
| `å•æ¬¡æé—®.bat` | å•æ¬¡é—®ç­” | è¾“å…¥é—®é¢˜ï¼Œè·å–å›ç­”åé€€å‡º |

**ä½¿ç”¨æ–¹æ³•**ï¼šç›´æ¥åŒå‡» `.bat` æ–‡ä»¶å³å¯å¯åŠ¨ã€‚

---

## ä½¿ç”¨

### 1. æµ‹è¯• Ollama è¿æ¥

```bash
npm start test
```

**é€‰é¡¹**ï¼š
- `-u, --url <url>` - Ollama API åœ°å€ï¼ˆé»˜è®¤ï¼šhttp://localhost:11434ï¼‰
- `-m, --model <model>` - AI æ¨¡å‹ï¼ˆé»˜è®¤ï¼šqwen2.5:3bï¼‰

**ç¤ºä¾‹**ï¼š
```bash
npm start test -- -u http://localhost:11434 -m qwen2.5:3b
```

### 2. ç”Ÿæˆæ—¥æŠ¥

```bash
npm start daily
```

**é€‰é¡¹**ï¼š
- `-w, --workspace <path>` - å·¥ä½œåŒºè·¯å¾„ï¼ˆé»˜è®¤ï¼šå½“å‰ç›®å½•ï¼‰
- `-k, --kb <path>` - çŸ¥è¯†åº“è·¯å¾„ï¼ˆé»˜è®¤ï¼šå·¥ä½œåŒº/knowledge-baseï¼‰
- `-u, --url <url>` - Ollama API åœ°å€
- `-m, --model <model>` - AI æ¨¡å‹

**ç¤ºä¾‹**ï¼š
```bash
# åœ¨å½“å‰ç›®å½•ç”Ÿæˆæ—¥æŠ¥
npm start daily

# æŒ‡å®šå·¥ä½œåŒº
npm start daily -- -w D:\G_GitHub\Kiro-KB-Plugin

# æŒ‡å®šçŸ¥è¯†åº“è·¯å¾„
npm start daily -- -w D:\G_GitHub\Kiro-KB-Plugin -k D:\G_GitHub\Kiro-Central-KB
```

### 3. ç”Ÿæˆå‘¨æŠ¥

```bash
npm start weekly
```

**é€‰é¡¹**ï¼šåŒæ—¥æŠ¥

**ç¤ºä¾‹**ï¼š
```bash
npm start weekly -- -w D:\G_GitHub\Kiro-KB-Plugin
```

### 4. æ™ºèƒ½é—®ç­”ï¼ˆAskï¼‰

è®©æœ¬åœ° AI è¯»å–çŸ¥è¯†åº“å›ç­”é—®é¢˜ï¼Œå¯¹è¯å†å²è‡ªåŠ¨ä¿å­˜ã€‚

```bash
npm start ask "ä½ çš„é—®é¢˜"
```

**é€‰é¡¹**ï¼š
- `-k, --kb <path>` - çŸ¥è¯†åº“è·¯å¾„ï¼ˆé»˜è®¤ï¼šD:\G_GitHub\Kiro-Central-KBï¼‰
- `-u, --url <url>` - Ollama API åœ°å€ï¼ˆé»˜è®¤ï¼šhttp://localhost:11434ï¼‰
- `-m, --model <model>` - AI æ¨¡å‹ï¼ˆé»˜è®¤ï¼šqwen2.5:3bï¼‰
- `--no-save` - ä¸ä¿å­˜å¯¹è¯è®°å½•

**ç¤ºä¾‹**ï¼š
```bash
# åŸºæœ¬é—®ç­”
npm start ask "å¦‚ä½•åœ¨ TypeScript ä¸­ä½¿ç”¨æ³›å‹ï¼Ÿ"

# æŒ‡å®šçŸ¥è¯†åº“è·¯å¾„
npm start ask "VSCode æ’ä»¶å¼€å‘æœ€ä½³å®è·µ" -- -k D:\G_GitHub\Kiro-Central-KB

# ä¸ä¿å­˜å¯¹è¯
npm start ask "å¿«é€Ÿé—®é¢˜" -- --no-save
```

**åŠŸèƒ½ç‰¹ç‚¹**ï¼š
- ğŸ§  **çŸ¥è¯†åº“ä¸Šä¸‹æ–‡** - è‡ªåŠ¨æœç´¢ç›¸å…³çŸ¥è¯†æ–‡ä»¶ï¼Œæä¾›ç»™ AI å‚è€ƒ
- ğŸ‘¤ **ç”¨æˆ·ç”»åƒ** - è¯»å–ç”¨æˆ·ç”»åƒï¼ŒAI ä¼šæ ¹æ®ä½ çš„æ“…é•¿é¢†åŸŸè°ƒæ•´å›ç­”
- ğŸ’¾ **å¯¹è¯ä¿å­˜** - å¯¹è¯è‡ªåŠ¨ä¿å­˜åˆ° `ai-data/sessions/`
- ğŸ“ **å­¦ä¹ ç¼ºå£** - é—®è¿‡çš„é—®é¢˜è®°å½•åˆ° `profile/learning-gaps.md`

### 5. å¤šè½®å¯¹è¯ï¼ˆChatï¼‰

äº¤äº’å¼å¤šè½®å¯¹è¯ï¼ŒAI ä¼šè®°ä½ä¸Šä¸‹æ–‡ï¼Œæ”¯æŒè¿ç»­å¯¹è¯ã€‚

```bash
npm start chat
```

**é€‰é¡¹**ï¼š
- `-k, --kb <path>` - çŸ¥è¯†åº“è·¯å¾„ï¼ˆé»˜è®¤ï¼šD:\G_GitHub\Kiro-Central-KBï¼‰
- `-u, --url <url>` - Ollama API åœ°å€ï¼ˆé»˜è®¤ï¼šhttp://localhost:11434ï¼‰
- `-m, --model <model>` - AI æ¨¡å‹ï¼ˆé»˜è®¤ï¼šqwen2.5:3bï¼‰

**äº¤äº’å‘½ä»¤**ï¼š
- `exit` / `quit` - é€€å‡ºå¯¹è¯ï¼ˆè‡ªåŠ¨ä¿å­˜ï¼‰
- `save` - æ‰‹åŠ¨ä¿å­˜å½“å‰å¯¹è¯
- `clear` - æ¸…ç©ºå¯¹è¯å†å²ï¼Œå¼€å§‹æ–°å¯¹è¯

**ç¤ºä¾‹**ï¼š
```bash
# å¯åŠ¨äº¤äº’å¼å¯¹è¯
npm start chat

# æŒ‡å®šçŸ¥è¯†åº“è·¯å¾„
npm start chat -- -k D:\G_GitHub\Kiro-Central-KB
```

**åŠŸèƒ½ç‰¹ç‚¹**ï¼š
- ğŸ”„ **ä¸Šä¸‹æ–‡è®°å¿†** - è®°ä½æœ€è¿‘ 10 è½®å¯¹è¯ï¼Œä¿æŒè¿è´¯
- ğŸ‘¤ **ç”¨æˆ·ç”»åƒ** - è¯»å–ç”¨æˆ·ç”»åƒï¼Œä¸ªæ€§åŒ–å›ç­”
- ğŸ’¾ **è‡ªåŠ¨ä¿å­˜** - é€€å‡ºæ—¶è‡ªåŠ¨ä¿å­˜å¯¹è¯åˆ° `ai-data/sessions/`
- ğŸ—‘ï¸ **æ¸…ç©ºå†å²** - éšæ—¶æ¸…ç©ºå†å²å¼€å§‹æ–°å¯¹è¯

### 6. æŸ¥çœ‹å¯¹è¯å†å²

```bash
npm start history
```

**é€‰é¡¹**ï¼š
- `-k, --kb <path>` - çŸ¥è¯†åº“è·¯å¾„ï¼ˆé»˜è®¤ï¼šD:\G_GitHub\Kiro-Central-KBï¼‰
- `-n, --count <number>` - æ˜¾ç¤ºæ¡æ•°ï¼ˆé»˜è®¤ï¼š5ï¼‰

**ç¤ºä¾‹**ï¼š
```bash
# æŸ¥çœ‹æœ€è¿‘5æ¡å¯¹è¯
npm start history

# æŸ¥çœ‹æœ€è¿‘10æ¡
npm start history -- -n 10
```

## ç½‘ç»œæœç´¢æ¨¡å—

`webSearch.ts` æ¨¡å—è®©æœ¬åœ° AI èƒ½å¤Ÿè·å–æœ€æ–°çš„ç½‘ç»œä¿¡æ¯ï¼Œè§£å†³æœ¬åœ°æ¨¡å‹çŸ¥è¯†æˆªæ­¢æ—¥æœŸçš„é—®é¢˜ã€‚

### åŠŸèƒ½

- ğŸ” **DuckDuckGo Instant Answer API** - å…è´¹ï¼Œæ— éœ€ API Keyï¼Œè¿”å›ç»“æ„åŒ–æ•°æ®
- ğŸ¤– **æ™ºèƒ½åˆ¤æ–­** - è‡ªåŠ¨è¯†åˆ«éœ€è¦è”ç½‘æœç´¢çš„é—®é¢˜
- ğŸ“ **æ ¼å¼åŒ–è¾“å‡º** - æœç´¢ç»“æœè‡ªåŠ¨æ ¼å¼åŒ–ä¸º AI ä¸Šä¸‹æ–‡
- ğŸ“Š **ç»“æ„åŒ–ç»“æœ** - æå– Abstract å’Œ RelatedTopicsï¼Œæä¾›æ›´å‡†ç¡®çš„ä¿¡æ¯

### API

```typescript
import { searchDuckDuckGo, needsWebSearch, searchAndFormat } from './webSearch';

// æ‰§è¡Œæœç´¢ï¼ˆä½¿ç”¨ Instant Answer APIï¼‰
const results = await searchDuckDuckGo('TypeScript 5.0 æ–°ç‰¹æ€§', 5);
// è¿”å›æ ¼å¼ï¼š
// [
//   { title: 'æ ‡é¢˜', url: 'URL', snippet: 'æ‘˜è¦', source: 'DuckDuckGo' },
//   ...
// ]

// åˆ¤æ–­æ˜¯å¦éœ€è¦è”ç½‘
if (needsWebSearch('æœ€æ–°çš„ Node.js ç‰ˆæœ¬æ˜¯å¤šå°‘ï¼Ÿ')) {
    // éœ€è¦è”ç½‘æœç´¢
}

// æœç´¢å¹¶æ ¼å¼åŒ–ï¼ˆæ¨èä½¿ç”¨ï¼‰
const { success, results, context } = await searchAndFormat('React 19 å‘å¸ƒæ—¥æœŸ');
// context æ˜¯æ ¼å¼åŒ–åçš„ Markdown æ–‡æœ¬ï¼Œå¯ç›´æ¥æä¾›ç»™ AI
```

### æœç´¢ç»“æœæ¥æº

ä½¿ç”¨ DuckDuckGo Instant Answer APIï¼Œç»“æœåŒ…å«ï¼š
- **Abstract** - ä¸»è¦ç­”æ¡ˆï¼ˆæ¥è‡ª Wikipediaã€å®˜æ–¹æ–‡æ¡£ç­‰ï¼‰
- **RelatedTopics** - ç›¸å…³ä¸»é¢˜é“¾æ¥ï¼ˆæœ€å¤šè¿”å› maxResults-1 ä¸ªï¼‰

ä¼˜ç‚¹ï¼š
- âœ… ç»“æ„åŒ–æ•°æ®ï¼Œè§£æå‡†ç¡®
- âœ… æ— éœ€å¤„ç† HTML
- âœ… è¿”å›é€Ÿåº¦å¿«
- âœ… åŒ…å«æƒå¨æ¥æºï¼ˆWikipediaã€å®˜æ–¹æ–‡æ¡£ï¼‰

### è§¦å‘å…³é”®è¯

ä»¥ä¸‹å…³é”®è¯ä¼šè§¦å‘è”ç½‘æœç´¢ï¼š
- æ—¶é—´ç›¸å…³ï¼š`æœ€æ–°`ã€`ç°åœ¨`ã€`ç›®å‰`ã€`å½“å‰`ã€`ä»Šå¤©`
- å¹´ä»½ï¼š`2024`ã€`2025`ã€`2026`
- ç‰ˆæœ¬ç›¸å…³ï¼š`æ–°ç‰ˆæœ¬`ã€`æ–°åŠŸèƒ½`ã€`æ›´æ–°`ã€`å‘å¸ƒ`
- è‹±æ–‡ï¼š`latest`ã€`new`ã€`update`ã€`release`ã€`version`

### ä½¿ç”¨åœºæ™¯

1. **è·å–æœ€æ–°ç‰ˆæœ¬ä¿¡æ¯**
   ```
   é—®ï¼šNode.js æœ€æ–°ç‰ˆæœ¬æ˜¯å¤šå°‘ï¼Ÿ
   â†’ è‡ªåŠ¨æœç´¢å¹¶è¿”å›æœ€æ–°ç‰ˆæœ¬ä¿¡æ¯
   ```

2. **æŸ¥è¯¢æŠ€æœ¯æ›´æ–°**
   ```
   é—®ï¼šTypeScript 5.0 æœ‰ä»€ä¹ˆæ–°ç‰¹æ€§ï¼Ÿ
   â†’ æœç´¢å¹¶æ•´åˆç½‘ç»œä¿¡æ¯
   ```

3. **å¯¹æ¯”å’Œè¯„æµ‹**
   ```
   é—®ï¼šReact å’Œ Vue 2024 å¹´å¯¹æ¯”
   â†’ è·å–æœ€æ–°çš„å¯¹æ¯”æ–‡ç« 
   ```

## è¾“å‡º

### æ—¥æŠ¥ä½ç½®
`knowledge-base/work-patterns/daily/YYYY-MM-DD.md`

### å‘¨æŠ¥ä½ç½®
`knowledge-base/work-patterns/weekly/YYYY-WXX.md`

### é—®ç­”å¯¹è¯ä½ç½®
`knowledge-base/ai-data/sessions/YYYY-MM-DD-HHMMSS.md`

### å¤šè½®å¯¹è¯ä½ç½®
`knowledge-base/ai-data/sessions/chat-YYYY-MM-DD-HHMMSS.md`

### å­¦ä¹ ç¼ºå£è®°å½•
`knowledge-base/profile/learning-gaps.md`

## æ•…éšœæ’æŸ¥

### é—®é¢˜ 1ï¼šOllama è¿æ¥å¤±è´¥

**é”™è¯¯**ï¼š`Connection failed: connect ECONNREFUSED`

**è§£å†³**ï¼š
1. ç¡®è®¤ Ollama æ­£åœ¨è¿è¡Œï¼š`ollama serve`
2. æ£€æŸ¥ç«¯å£ï¼šé»˜è®¤ 11434
3. æµ‹è¯•è¿æ¥ï¼š`curl http://localhost:11434/api/tags`

### é—®é¢˜ 2ï¼šæ¨¡å‹æœªæ‰¾åˆ°

**é”™è¯¯**ï¼š`Model not found: qwen2.5:3b`

**è§£å†³**ï¼š
```bash
ollama pull qwen2.5:3b
```

### é—®é¢˜ 3ï¼šå·¥ä½œåŒºè·¯å¾„ä¸å­˜åœ¨

**é”™è¯¯**ï¼š`å·¥ä½œåŒºè·¯å¾„ä¸å­˜åœ¨`

**è§£å†³**ï¼š
ä½¿ç”¨ `-w` é€‰é¡¹æŒ‡å®šæ­£ç¡®çš„å·¥ä½œåŒºè·¯å¾„

## å¼€å‘

### ç¼–è¯‘
```bash
npm run build
```

### å¼€å‘æ¨¡å¼
```bash
npm run dev
```

## æ¶æ„

```
ollama-cli/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ index.ts              # ä¸»ç¨‹åºï¼ˆCLI å…¥å£ï¼‰
â”‚   â”œâ”€â”€ logger.ts             # æ§åˆ¶å°æ—¥å¿—
â”‚   â”œâ”€â”€ ollama.ts             # Ollama å®¢æˆ·ç«¯ï¼ˆç‹¬ç«‹æ¨¡å—ï¼Œä¸ä¾èµ– VSCode APIï¼‰
â”‚   â”œâ”€â”€ askCommand.ts         # æ™ºèƒ½é—®ç­”å‘½ä»¤ï¼ˆå•è½®ï¼‰
â”‚   â”œâ”€â”€ chatCommand.ts        # å¤šè½®å¯¹è¯å‘½ä»¤ï¼ˆäº¤äº’å¼ï¼‰
â”‚   â”œâ”€â”€ webSearch.ts          # ç½‘ç»œæœç´¢æ¨¡å—ï¼ˆDuckDuckGoï¼‰
â”‚   â”œâ”€â”€ workPatternTracker.ts # å·¥ä½œè¿½è¸ªå™¨
â”‚   â””â”€â”€ reportGenerator.ts    # æŠ¥å‘Šç”Ÿæˆå™¨
â”œâ”€â”€ dist/                     # ç¼–è¯‘è¾“å‡º
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â””â”€â”€ README.md
```

### è®¾è®¡åŸåˆ™

- **ç‹¬ç«‹æ€§**ï¼šæ‰€æœ‰æ¨¡å—ä¸ä¾èµ– VSCode/Kiro APIï¼Œå¯åœ¨çº¯ Node.js ç¯å¢ƒè¿è¡Œ
- **å¯å¤ç”¨**ï¼šæ ¸å¿ƒæ¨¡å—ï¼ˆ`ollama.ts`ã€`workPatternTracker.ts`ã€`reportGenerator.ts`ï¼‰å¯è¢«æ’ä»¶å’Œ CLI å…±äº«
- **æ¥å£æŠ½è±¡**ï¼šä½¿ç”¨æ¥å£ï¼ˆå¦‚ `OutputChannel`ï¼‰è€Œéå…·ä½“å®ç°ï¼Œä¾¿äºä¸åŒç¯å¢ƒé€‚é…

## ä¸æ’ä»¶çš„åŒºåˆ«

| ç‰¹æ€§ | CLI å·¥å…· | Kiro IDE æ’ä»¶ |
|------|----------|---------------|
| è¿è¡Œç¯å¢ƒ | å‘½ä»¤è¡Œ | Kiro IDE |
| ä¾èµ– | Node.js | Kiro IDE |
| ä½¿ç”¨æ–¹å¼ | æ‰‹åŠ¨æ‰§è¡Œå‘½ä»¤ | è‡ªåŠ¨/å¿«æ·é”® |
| é€‚ç”¨åœºæ™¯ | æµ‹è¯•ã€è„šæœ¬ | æ—¥å¸¸å¼€å‘ |

## ä¸‹ä¸€æ­¥

1. âœ… æµ‹è¯• CLI å·¥å…·æ˜¯å¦æ­£å¸¸å·¥ä½œ
2. â³ éªŒè¯æ—¥æŠ¥/å‘¨æŠ¥ç”ŸæˆåŠŸèƒ½
3. â³ è°ƒè¯• Kiro IDE æ’ä»¶é›†æˆé—®é¢˜
4. â³ å°† CLI å·¥å…·é›†æˆåˆ°æ’ä»¶ä¸­

## è®¸å¯è¯

MIT
