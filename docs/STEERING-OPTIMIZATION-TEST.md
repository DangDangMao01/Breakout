# Steering 规则优化测试

**优化时间**: 2026-01-29  
**目标**: 解决 Steering 规则触发不够强的问题

---

## 🎯 优化内容

### 1. 添加直接问题触发表

**新增功能**: 用户说特定问题时，立即执行对应操作

| 用户问题 | 立即执行 |
|---------|---------|
| "今天我探讨的什么？" | 读取 `knowledge-base/notes/YYYYMMDD-今日对话总结.md` |
| "今天讨论了什么？" | 读取 `knowledge-base/notes/YYYYMMDD-今日对话总结.md` |
| "继续开发" | 读取 `SESSION-STATE.md` 和最新会话记录 |
| "继续工作" | 读取 `SESSION-STATE.md` 和最新会话记录 |
| "我们之前讨论过..." | 检索中央知识库和本地知识库 |
| "之前说过..." | 检索中央知识库和本地知识库 |
| "保存到知识库" | 评估对话质量并保存 |

### 2. 扩展关键词触发列表

**新增关键词**:
- Ollama, Qwen → 本地 AI 系统
- 向量数据库, ChromaDB → 超长记忆实现
- 项目名称（Kiro-KB-Plugin, DevBrain-App）→ 检索对应项目文档

### 3. 明确检索顺序

**优先级**:
1. 本地知识库优先（`knowledge-base/`）
2. 中央知识库次之（`D:\G_GitHub\Kiro-Central-KB\`）
3. 其他项目最后（`incubator/graduated/`）

### 4. 添加常见错误清单

**避免的错误**:
- ❌ 用户问"今天探讨的什么？"，回答"让我检索..."
- ❌ 用户提到"Hook"，直接回答
- ❌ 检索到相关文档，但没有读取
- ❌ 发现重复讨论，但没有提醒用户

**正确的做法**:
- ✅ 立即读取对应文档
- ✅ 先检索知识库，找到相关讨论，再回答
- ✅ 必须读取完整内容，然后基于内容回答
- ✅ 必须提醒用户，避免重叠开发

---

## 🧪 测试用例

### 测试 1: 直接问题触发

**输入**: "今天我探讨的什么？"

**预期行为**:
1. ✅ 立即读取 `knowledge-base/notes/20260129-今日对话总结.md`
2. ✅ 不说"让我检索..."
3. ✅ 直接基于文档内容回答
4. ✅ 总结今天的核心讨论

**实际结果**: 
- [ ] 通过 / [ ] 失败
- 问题: 
- 改进:

---

### 测试 2: 关键词触发

**输入**: "Hook 可以实现跨设备上下文恢复吗？"

**预期行为**:
1. ✅ 检测到关键词"Hook"和"跨设备"
2. ✅ 主动说："我发现这个话题之前可能讨论过"
3. ✅ 检索本地知识库 + 中央知识库 + 其他项目
4. ✅ 列出找到的文档
5. ✅ 读取所有相关文档
6. ✅ 基于历史上下文回答

**实际结果**: 
- [ ] 通过 / [ ] 失败
- 问题: 
- 改进:

---

### 测试 3: 继续开发触发

**输入**: "继续开发"

**预期行为**:
1. ✅ 立即读取 `SESSION-STATE.md`
2. ✅ 读取最新的会话记录
3. ✅ 总结当前状态
4. ✅ 告诉用户下一步可以做什么

**实际结果**: 
- [ ] 通过 / [ ] 失败
- 问题: 
- 改进:

---

### 测试 4: 保存到知识库触发

**输入**: "保存到知识库"

**预期行为**:
1. ✅ 评估对话质量
2. ✅ 确定保存位置（solutions/notes/discussions）
3. ✅ 生成文件名（YYYYMMDD-主题.md）
4. ✅ 添加元数据（domain, tags, source_project）
5. ✅ 保存到本地知识库
6. ✅ 提醒用户同步到中央知识库

**实际结果**: 
- [ ] 通过 / [ ] 失败
- 问题: 
- 改进:

---

### 测试 5: 重复讨论检测

**输入**: "我们讨论下 Clawdbot 的实现原理"

**预期行为**:
1. ✅ 检测到关键词"Clawdbot"
2. ✅ 检索知识库，找到相关讨论
3. ✅ 提醒用户："我在 [日期] 的 [项目名] 中发现了相关讨论"
4. ✅ 列出找到的文档
5. ✅ 读取相关文档
6. ✅ 基于历史上下文回答，避免重复

**实际结果**: 
- [ ] 通过 / [ ] 失败
- 问题: 
- 改进:

---

## 📊 测试结果总结

**测试时间**: 2026-01-29 晚上  
**测试设备**: 家里的设备

### 通过率
- 测试 1: [ ] 通过 / [ ] 失败
- 测试 2: [ ] 通过 / [ ] 失败
- 测试 3: [ ] 通过 / [ ] 失败
- 测试 4: [ ] 通过 / [ ] 失败
- 测试 5: [ ] 通过 / [ ] 失败

**总通过率**: __/5 (__%)

### 主要问题
1. 
2. 
3. 

### 改进建议
1. 
2. 
3. 

---

## 🔄 下一步

如果测试失败：
1. 分析失败原因
2. 进一步优化 Steering 规则
3. 考虑是否需要更强的触发机制
4. 重新测试

如果测试成功：
1. 应用到所有项目
2. 更新文档
3. 开始 Phase 1 开发（来源追踪、重复检测）

---

**创建时间**: 2026-01-29  
**状态**: 待测试
